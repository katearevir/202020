<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css?family=Dekko" rel="stylesheet">
    <title>Pomodoro</title>
</head>
<body>

    <audio id="sound">
        <source src="Melody 1.mp3" type="audio/mpeg">
        Your browser does not support the audio element.
    </audio>
    
    <h1>Pomodoro</h1>
    <span style="font-size: 30px">Work Time!</span>
    <div class="flex-container">

        <div class="timer">
            
            <p id="countdown">25:00</p>
        </div>
    
        <div class="settings">
            <button id="playPause" type="button">Start</button>
            <br>
            <button id="restart" type="button">Restart</button>
        </div>

        <div class="bear">
            <img src="bear.png">
        </div>

        <div class="playlist">
            <iframe width="560" height="315" src="https://www.youtube.com/embed/VMAPTo7RVCo?autoplay=1" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"></iframe>
        </div>
    </div>
    

    
</body>

<script>
var play = true;
var restart = false;

var restartButton = document.getElementById("restart");
var sound = document.getElementById("sound");
sound.volume = 0.05;

function startTimer(duration, display) {

    return new Promise(function(resolve, reject) {
        var timer = duration, minutes, seconds;
        
    var inter = setInterval(function () {
        if (play){
            minutes = parseInt(timer / 60, 10);
            seconds = parseInt(timer % 60, 10);

            minutes = minutes < 10 ? "0" + minutes : minutes;
            seconds = seconds < 10 ? "0" + seconds : seconds;

            display.textContent = minutes + ":" + seconds;
            
            if (--timer < 0) {
                sound.play();
                clearInterval(inter);
                resolve("timer ended");
            }
            if (restart){
                display.textContent = "25:00";
                clearInterval(inter);
                resolve("timer ended");
            }
        }
        
    }, 1000);
                
    
    });
    
}

var playPauseButton = document.getElementById("playPause");

playPauseButton.onclick = function() {
    if (playPauseButton.innerText == "Start"){
        play = true;
        restart = false;
        playPauseButton.innerText = "Pause"
        display();
    }
    else if (playPauseButton.innerText == "Play"){
        play = true;
        playPauseButton.innerText = "Pause";
    }
    else if (playPauseButton.innerText == "Pause"){
        play = false;
        playPauseButton.innerText = "Play";
    }

}

restartButton.onclick = function(){
    playPauseButton.innerText = "Start";
    restart = true;
}
    
async function display() {
    var display = document.querySelector('#countdown');

    while(!restart){
        if (!restart)
        {
        var firstTime = 60 * 25; //25 mins
        await startTimer(firstTime, display);
        console.log("first timer" + restart)
        if (!restart)
        {
            console.log("second timer" + restart)
            var five = 60*5; // 5 mins
            await startTimer(five, display);
        }
            
        }
    }
    

    
    

}

</script>
</html>